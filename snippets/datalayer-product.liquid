{%- liquid
   assign current_variant = product.selected_or_first_available_variant
   assign value = current_variant.price | divided by 100
   assign quantity = 1
   assign total_value = value * quantity
-%}
<script>

  console.log("datalayer-product snippet is loaded")
  //Item Object
  var itemObject = {
    item_id = {{current_variant.id | json}},
    id = {{current_variant.id | json}},
    item_name: {{product.title | json}},
    currency: {{ shop.currency | json }},
    item_brand: {{ product.vendor | json }},
    item_category: {{ product.type | json }},
    item_variant: {{ current_variant.title | json }},
    price: {{ current_variant.price | json }},
    google_business_vertical: 'retail',
    quantity: 1
  }

  document.addEventListener('DomContentLoaded', () => {

    //view item
    dataLayer.push({ ecommerce: null })
    dataLayer.push({
      event: 'custom_view_item',
      ecommerce: {
        currency: {{ shop.currency | json }},
        items: [itemObject],
        value: {{ total_value | json}}
      }
    });
  //Add to cart
  const addToCartBtn = document.querySelector('[name="add"]')
  addToCartBtn?.addEventListener('click', () {
    dataLayer.push({ ecommerce: null })
    dataLayer.push({
      event: 'SME_add_to_cart',
      ecommerce: {
        currency: {{ shop.currency | json }},
        items: [itemObject],
        value: {{ total_value | json}}
      }
    });
  })
  })
</script>